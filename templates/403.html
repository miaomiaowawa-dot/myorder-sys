<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>æƒé™ä¸è¶³ - è®¢å•ç®¡ç†ç³»ç»Ÿ</title>
    <link href="https://cdn.jsdelivr.net/npm/layui@2.6.8/css/layui.css" rel="stylesheet">
    <style>
        body {
            background: #f2f2f2;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-family: "Microsoft YaHei", sans-serif;
        }
        .error-container {
            text-align: center;
            background: white;
            padding: 50px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 90%;
        }
        .error-icon {
            font-size: 80px;
            color: #ffb800;
            margin-bottom: 20px;
        }
        .error-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 15px;
        }
        .error-message {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .user-info {
            background: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #ffb800;
        }
        .action-buttons {
            margin-top: 30px;
        }
        .permission-list {
            text-align: left;
            margin: 20px 0;
            padding: 15px;
            background: #f8f8f8;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-icon">
            <i class="layui-icon layui-icon-face-surprised"></i>
        </div>
        <h1 class="error-title">403 - æƒé™ä¸è¶³</h1>
        <div class="error-message">
            <p>æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢ã€‚</p>
            <p>è¯¥åŠŸèƒ½éœ€è¦æ›´é«˜çš„æƒé™çº§åˆ«æ‰èƒ½ä½¿ç”¨ã€‚</p>
        </div>
        
        <div class="user-info">
            <strong>å½“å‰ç”¨æˆ·ä¿¡æ¯</strong><br>
            ç”¨æˆ·å: {{ current_user.username if current_user.is_authenticated else 'æœªç™»å½•' }}<br>
            è§’è‰²: {{ current_user.role if current_user.is_authenticated else 'æœªçŸ¥' }}
        </div>
        
        <div class="permission-list">
            <strong>ğŸ’¡ æ‚¨å¯èƒ½éœ€è¦ä»¥ä¸‹æƒé™ï¼š</strong>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>ç®¡ç†å‘˜æƒé™</li>
                <li>ç»ç†æƒé™</li>
                <li>ç‰¹å®šåŠŸèƒ½æ¨¡å—çš„è®¿é—®æƒé™</li>
            </ul>
        </div>
        
        <div class="action-buttons">
            <button class="layui-btn layui-btn-primary" onclick="history.back()">
                <i class="layui-icon layui-icon-left"></i> è¿”å›ä¸Šé¡µ
            </button>
            {% if current_user.is_authenticated %}
            <button class="layui-btn layui-btn-normal" onclick="goDashboard()">
                <i class="layui-icon layui-icon-home"></i> è¿”å›é¦–é¡µ
            </button>
            {% else %}
            <button class="layui-btn layui-btn-warm" onclick="goLogin()">
                <i class="layui-icon layui-icon-user"></i> é‡æ–°ç™»å½•
            </button>
            {% endif %}
            <button class="layui-btn" onclick="requestPermission()">
                <i class="layui-icon layui-icon-service"></i> ç”³è¯·æƒé™
            </button>
        </div>
        
        <div style="margin-top: 20px; color: #999; font-size: 12px;">
            å¦‚éœ€æå‡æƒé™ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/layui@2.6.8/layui.js"></script>
    <script>
        function goDashboard() {
            window.location.href = '/dashboard';
        }
        
        function goLogin() {
            window.location.href = '/login';
        }
        
        function requestPermission() {
            layui.use('layer', function(){
                var layer = layui.layer;
                layer.open({
                    type: 1,
                    title: 'æƒé™ç”³è¯·',
                    area: ['400px', '300px'],
                    content: `
                        <div style="padding: 20px;">
                            <form class="layui-form">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">ç”³è¯·åŸå› </label>
                                    <div class="layui-input-block">
                                        <textarea name="reason" placeholder="è¯·è¯´æ˜ä¸ºä»€ä¹ˆéœ€è¦æ­¤æƒé™" 
                                                  class="layui-textarea" rows="4"></textarea>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-block">
                                        <button class="layui-btn" lay-submit lay-filter="permission-form">æäº¤ç”³è¯·</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    `,
                    success: function(layero, index){
                        layui.form.on('submit(permission-form)', function(data){
                            layer.msg('æƒé™ç”³è¯·å·²æäº¤ï¼Œç®¡ç†å‘˜å°†åœ¨1-3ä¸ªå·¥ä½œæ—¥å†…å¤„ç†');
                            layer.close(index);
                            return false;
                        });
                    }
                });
            });
        }
    </script>
</body>
</html>